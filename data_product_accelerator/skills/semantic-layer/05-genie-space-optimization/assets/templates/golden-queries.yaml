# Golden Queries Template for Genie Space Optimization
#
# Structure: domain â†’ list of benchmark questions
#
# Each question requires:
#   - id: Unique identifier (domain_NNN format)
#   - question: Natural language question
#   - expected_sql: Working SQL that returns correct result
#   - expected_asset: MV (Metric View), TVF (Table-Valued Function), or TABLE
#   - category: aggregation, ranking, time-series, comparison, detail, list, threshold
#
# Coverage Guidelines:
#   - At least 10 questions per domain
#   - At least 4 different categories
#   - Include synonym variations for key queries
#   - Include date range variations
#   - Include edge cases (nulls, empty results)
#
# SQL Rules:
#   - Use ${catalog}.${gold_schema} template variables
#   - MEASURE() uses column names, NOT display names
#   - TVF calls include all required parameters (all STRING type)
#   - Full 3-part UC namespace for all objects

# =============================================================================
# Example Domain: Cost Intelligence
# =============================================================================

cost:
  # --- Aggregation Queries (Metric View) ---
  - id: "cost_001"
    question: "What is our total compute spend this month?"
    expected_sql: >
      SELECT MEASURE(total_cost)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
      WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())
    expected_asset: "MV"
    category: "aggregation"

  - id: "cost_002"
    question: "How much have we spent?"
    expected_sql: >
      SELECT MEASURE(total_cost)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
    expected_asset: "MV"
    category: "aggregation"

  - id: "cost_003"
    question: "What is our average daily cost?"
    expected_sql: >
      SELECT MEASURE(avg_daily_cost)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
    expected_asset: "MV"
    category: "aggregation"

  # --- Ranking Queries (TVF) ---
  - id: "cost_010"
    question: "Show the top 10 most expensive workspaces"
    expected_sql: >
      SELECT *
      FROM ${catalog}.${gold_schema}.get_top_cost_contributors('30', 'workspace')
      LIMIT 10
    expected_asset: "TVF"
    category: "ranking"

  - id: "cost_011"
    question: "Which SKUs cost the most?"
    expected_sql: >
      SELECT *
      FROM ${catalog}.${gold_schema}.get_top_cost_contributors('30', 'sku')
    expected_asset: "TVF"
    category: "ranking"

  # --- Time-Series Queries (TVF) ---
  - id: "cost_020"
    question: "Show daily cost breakdown for the last 2 weeks"
    expected_sql: >
      SELECT *
      FROM ${catalog}.${gold_schema}.get_daily_cost_summary(
        CAST(DATE_SUB(CURRENT_DATE(), 14) AS STRING),
        CAST(CURRENT_DATE() AS STRING)
      )
    expected_asset: "TVF"
    category: "time-series"

  - id: "cost_021"
    question: "What was our daily spend last month?"
    expected_sql: >
      SELECT *
      FROM ${catalog}.${gold_schema}.get_daily_cost_summary(
        CAST(DATE_TRUNC('month', ADD_MONTHS(CURRENT_DATE(), -1)) AS STRING),
        CAST(LAST_DAY(ADD_MONTHS(CURRENT_DATE(), -1)) AS STRING)
      )
    expected_asset: "TVF"
    category: "time-series"

  # --- Comparison Queries ---
  - id: "cost_030"
    question: "Compare this month's cost to last month"
    expected_sql: >
      SELECT
        'This Month' as period,
        MEASURE(total_cost) as cost
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
      WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())
      UNION ALL
      SELECT
        'Last Month',
        MEASURE(total_cost)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
      WHERE usage_date >= DATE_TRUNC('month', ADD_MONTHS(CURRENT_DATE(), -1))
        AND usage_date < DATE_TRUNC('month', CURRENT_DATE())
    expected_asset: "MV"
    category: "comparison"

  # --- Detail / List Queries ---
  - id: "cost_040"
    question: "What SKU categories do we use?"
    expected_sql: >
      SELECT DISTINCT sku_category, sku_description
      FROM ${catalog}.${gold_schema}.dim_sku
      ORDER BY sku_category
    expected_asset: "TABLE"
    category: "list"

  # --- Synonym Variations ---
  - id: "cost_050"
    question: "What are our total costs?"
    expected_sql: >
      SELECT MEASURE(total_cost)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
    expected_asset: "MV"
    category: "aggregation"

  - id: "cost_051"
    question: "Total DBU consumption this quarter"
    expected_sql: >
      SELECT MEASURE(total_dbus)
      FROM ${catalog}.${gold_schema}.mv_cost_analytics
      WHERE usage_date >= DATE_TRUNC('quarter', CURRENT_DATE())
    expected_asset: "MV"
    category: "aggregation"


# =============================================================================
# Add your domain benchmarks below using the same structure
# =============================================================================

# reliability:
#   - id: "rel_001"
#     question: "..."
#     expected_sql: "..."
#     expected_asset: "MV|TVF|TABLE"
#     category: "..."

# security:
#   - id: "sec_001"
#     ...

# performance:
#   - id: "perf_001"
#     ...

# quality:
#   - id: "qual_001"
#     ...
